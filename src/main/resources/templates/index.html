<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" data-name="vs/editor/editor.main" th:href="@{/static/node_modules/monaco-editor/min/vs/editor/editor.main.css}"/>
    <script>var require = {paths: {'vs': '../node_modules/monaco-editor/min/vs'}};</script>
    <script th:src="@{/static/node_modules/monaco-editor/min/vs/loader.js}"></script>
    <script th:src="@{/static/node_modules/monaco-editor/min/vs/editor/editor.main.nls.js}"></script>
    <script th:src="@{/static/node_modules/monaco-editor/min/vs/editor/editor.main.js}"></script>
    <title>메인</title>
    <style>
        #monaco { min-height:300px; }
    </style>
</head>
<body>
    <h2>메인</h2>
    <div>
        <h2>온라인 코드 에디터</h2>
        <div class="form-wrap">
            <select name="language" id="language" onchange="changeLanuage()">
                <option value="java" selected>JAVA</option>
                <option value="javascript">Javascript</option>
                <option value="html">HTML</option>
                <option value="css">CSS</option>
                <option value="react">REACT</option>
            </select>
        </div>
        <pre id="monaco"></pre>
        <div class="form-wrap">
            <input type="text" name="filename" id="filename">
            <button type="button" id="btn1" class="btn btn-primary">저장</button>
        </div>
    </div>

    <script th:inline="javascript">
        function setEditor(inputValue, inputLanguage){
            return {
                value: inputValue,
                language: "html",    // 언어
                theme: "vs-dark",   // 테마
                lineNumbers: 'on',  // 줄 번호
                glyphMargin: false, // 체크 이미지 넣을 공간이 생김
                vertical: 'auto',
                horizontal: 'auto',
                verticalScrollbarSize: 10,
                horizontalScrollbarSize: 10,
                scrollBeyondLastLine: false, // 에디터상에서 스크롤이 가능하게
                readOnly: false,    // 수정 가능 여부
                automaticLayout: true, // 부모 div 크기에 맞춰서 자동으로 editor 크기 맞춰줌
                minimap: {
                    enabled: true // 우측 스크롤 미니맵
                },
                lineHeight: 19
            }
        }
        /*<![CDATA[*/
        const monaco_test = new monaco.editor.create(document.getElementById('monaco'), setEditor([[${value}]], [[${language}]]));
        $('#monaco').height((monaco_test.getModel().getLineCount() * 19) + 10); // 19 = 줄 높이, 10 = 세로 스크롤 높이
        /*]]>*/
    </script>
    <script>
        function changeLanuage(){

        }
    </script>
    <script>
    document.getElementById("btn1").addEventListener("click", () => {
        let filename = document.getElementById("filename").value;
        let monaco = document.getElementsByClassName("mtk1")[0].values;
        console.log(filename);
        console.log(monaco);
        let memo = { 'filename':filename, 'monaco': monaco };
        axios.post("/api/test1", memo).then((response) => {
            console.log(response.data);
        })
        .catch((error) => {
           console.log(error);
        });
    })
    </script>
</body>
</html>