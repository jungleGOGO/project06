<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <title>연습장</title>
    <th:block th:insert="~{layout/head :: head}"></th:block>
    <link rel="stylesheet" th:href="@{/static/css/main.css}" />
    <script th:src="@{/static/js/main.js}" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/monokai.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
    <link rel="stylesheet" href="https://unpkg.com/gijgo@1.9.14/css/gijgo.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/swisnl/jQuery-contextMenu/2.9.0/dist/jquery.contextMenu.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/css/css.min.js"></script>
    <script src="https://unpkg.com/gijgo@1.9.14/js/gijgo.min.js" type="text/javascript"></script>
    <script src="https://cdn.rawgit.com/swisnl/jQuery-contextMenu/2.9.0/dist/jquery.contextMenu.min.js"></script>
</head>
<body>
<nav class="navbar navbar-light bg-dark" >
    <a th:href="@{/}" style="padding: 1px"><img th:src="@{/static/img/logo/logo.png}" alt="로고이미지" title="tcoding 로고" id="logoImage"></a>
    <span class="material-symbols-outlined" data-bs-toggle="modal" data-bs-target="#exampleModal" style="font-size: 22px; color: #fff;">info</span>
</nav>

<div id="iconNav">
    <a><i class="fa-solid fa-user" style="color:#fff;"></i></a>
    <div id="balloon-wrap">
        <ul id="balloon">
            <li><a th:href="@{/java/project}">프로젝트</a></li>
            <th:block sec:authorize="hasRole('USER')">
                <li><a th:href="@{/member/mypage}">마이페이지</a></li>
            </th:block>
            <th:block sec:authorize="hasRole('ADMIN')">
                <li><a th:href="@{/admin/dash}">관리자페이지</a></li>
            </th:block>
            <li><a th:href="@{/logout}">로그아웃</a></li>
        </ul>
    </div>
</div>

<main>
    <div class="container-fluid" style="background-color:black;">
    <div class="row gx-5 mt-2">
<!--        id=filename의 변경이 감지되면 해당 파일의 이름변경으로 인식.-->
<!--        현재는 filename + extension으로 파일이름을 저장하고 있음.-->
<!--        불러오면 파일형식 또한 변화를 줘야됨. 확장자는 파일저장, 불러오기때만 input 창 존재-->
        <!-- 불러온파일의 확장자를 따로 값 저장해야됨...hidden으로 숨길예정 -->
<!--        모달창으로 저장,다른이름으로 저장-->
        <div class="col-9 d-flex gx-5">
            <input type="text" name="filename" id="filename" value="untitled">
            <input type="hidden" name="filename2" id="filename2" >
            <span class="material-symbols-outlined " id="run" title="실행" style="font-size: 34px; margin: 0 2px;">play_circle</span>
            <span class="material-symbols-outlined" id="clear" title="전체 지우기" style="font-size: 34px; margin: 0 2px;">ink_eraser</span>
        </div>
        <div class="col-3 d-flex">
            <div class="form-check form-switch">
                <label class="form-check-label" for="autoSaveCheck">자동저장</label>
                <input class="form-check-input" type="checkbox" role="switch" id="autoSaveCheck">
                <span id="checkCircle" class="material-symbols-outlined" >check_circle</span>

            <button type="button" class="btn btn-dark"><span class="material-symbols-outlined" id="save" title="저장">save</span>저장</button>
            <button type="button" class="btn btn-dark"><span class="material-symbols-outlined" id="loadFileBtn" onclick="showFileList()" title="저장소">dns</span>저장소</button>
            </div>
            <div id="moreNav">
                <a><i class="fa-solid fa-ellipsis-vertical" style="color: #f7f7f8; padding-left: 6px; padding-right: 6px"></i></a>
                <div id="balloon-wrap2">
                    <ul id="balloon2">
                        <li><span class="material-symbols-outlined" id="saveBtn" title="다운로드">download</span>다운로드</li>
                        <li><span class="material-symbols-outlined"  title="다른이름으로 저장">save_as</span>다른이름으로저장</li>
                        <li><span class="material-symbols-outlined" id="readFile" title="내 파일읽기">upload_file</span>내파일읽기</li>
                    </ul>
                </div>
            </div>

        </div>
<!--        <label for="extension">파일확장자</label>-->
<!--        <select id="extension">-->
<!--            <option value=".html">.html</option>-->
<!--            <option value=".txt">.txt</option>-->
<!--            <option value="">직접입력</option>-->
<!--        </select>-->
<!--        <label for="downloadName">현재출력중인 파일</label>-->
<!--        <input type="text" name="downloadName" id="downloadName" readonly>-->
<!--        <div id="customExtensionInput" style="display: none;">-->
<!--            <label for="customExtension">직접입력 확장자</label>-->
<!--            <input type="text" id="customExtension" name="customExtension" placeholder=".html, .txt, ...">-->
<!--        </div>-->
    </div>
<!--        파일리스트 모달창-->
    <div class="modal" id="fileListModal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="pane">
                <div id="tree"></div>
            </div>
        </div>
    </div>
<!--이름변경 모달창-->
    <div class="modal" id="renameFileModal" >
        <div class="modal-content" style="background: black">
            <span class="close" onclick="closeRenameFileModal()">&times;</span>
            <label for="selectedFile">현재 이름:</label>
            <input class="form-label" type="text" id="selectedFile" name="selectedFile" readonly>
            <label for="newFilename">변경할 이름:</label>
            <input class="form-label" type="text" id="newFilename" name="newFilename" placeholder="파일명을 입력해주세요">
            <label for="reextension">파일확장자</label>
            <select id="reextension">
                <option value=".html">.html</option>
                <option value=".txt">.txt</option>
                <option value="">직접입력</option>
            </select>
            <div id="recustomExtensionInput" style="display: none;">
            <label for="recustomExtension">직접입력 확장자</label>
            <input type="text" id="recustomExtension" name="recustomExtension" placeholder=".html, .txt, ...">
            </div>
            <button onclick="renameFile()">변경</button>
        </div>
    </div>

        <div class="modal" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" >
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header" style="background-color: black">
                        <h5 class="modal-title" id="exampleModalLabel">도움말</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="background-color: black">
                        <!-- 모달 내용 -->
                        <span class="material-symbols-outlined">save</span> <p>다운로드 버튼</p> <hr>
                        <span class="material-symbols-outlined">dns</span> <p>저장소 열기</p><hr>
                        <span class="material-symbols-outlined">download</span> <p>현재 파일 다운받기</p><hr>
                        <span class="material-symbols-outlined">play_circle</span> <p>결과 보기</p><hr>
                        <span class="material-symbols-outlined">ink_eraser</span> <p>TML, CSS, JS에 입력한 코드 전체 지우기</p><hr>
                        <span class="material-symbols-outlined">contract_edit</span> <p>다른 이름으로 저장</p><hr>
                        <p>자동저장 on/off 버튼으로 설정 제어 가능합니다. on 경우 10초마다 자동저장을 합니다</p> <hr>
                        <p>자동저장 off 상태에서는 입력한 값이 10초마다 로컬스토리지에 저장되고 있습니다. </p> <hr>
                        <p>로컬스토리지에 저장된 값이 있으면 페이지 로딩시 이전 작업물을 이어서 작업할지 선택할 수 있습니다.</p> <hr>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>



        <section class="boxes">
            <div class="editor-container tab-pane">
                <div class="editor-header tab">
                    <h2>HTML <span class="material-symbols-outlined" id="clearHtml" title="html 지우기">ink_eraser</span></h2>
                </div>
                <textarea data-html id="htmlTextarea"></textarea>
            </div>
            <div class="editor-container tab-pane">
                <div class="editor-header tab">
                    <h2>CSS<span class="material-symbols-outlined" id="clearCss" title="css 지우기">ink_eraser</span></h2>
                    <textarea data-css id="cssTextarea"></textarea>
                </div>
            </div>
            <div class="editor-container tab-pane" style="border-right: 1px solid #5c5b5b;">
                <div class="editor-header tab" style="padding-right: 0px;">
                    <h2>JS <span class="material-symbols-outlined" id="clearJs" title="js 지우기">ink_eraser</span></h2>
                    <textarea data-js id="jsTextarea"></textarea>
                </div>
            </div>
        </section>
    </div>
    <div style="background: black; padding-top: 14px;">
        <p id="resultDiv">결과</p>
    </div>
    <div >
        <iframe data-code id="content"></iframe>
    </div>
</main>
</body>

</html>